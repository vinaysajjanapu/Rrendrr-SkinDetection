Modified from intel's sample project
